<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="WsgiDAV/{{ version }}" />
    <title>WsgiDAV - Index of {{ display_path }}</title>

    <link rel="shortcut icon" href="{{ htdocs }}/favicon.ico" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-reboot@4.5.6/reboot.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" /> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mar10/wunderbaum@main/dist/wunderbaum.css" />
    <link rel="stylesheet" href="{{ htdocs }}/app.css" />

    <!-- <script type="importmap">
      {
        "imports": {
          "@popperjs/core": "https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/esm/popper.min.js",
          "bootstrap": "https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.esm.min.js"
        }
      }
    </script> -->
    <script>
      const config = {{ js_config | tojson | safe }};
    </script>
    <script defer type="module" src="{{ htdocs }}/app.js"></script>
  </head>
  <body>
    <header>
      <h1>
        {%- if icon %}
        <img class="logo" alt="WsgiDAV" title="WsgiDAV" src="{{ htdocs }}/logo.png" />
        {% endif -%} <small>Wsgi</small>DAV-Explorer
        <!-- Index of {{ display_path }} -->
      </h1>

      <div class="header-bar">
        <span class="header-bar-left">
          <i class="wb-button bi bi-arrow-clockwise" title="Reload" data-command="reloadTree"></i>
          <i class="wb-button bi bi-cloud-plus" title="Upload file to root folder..." data-command="uploadTop"></i>
          <i class="wb-button bi bi-folder-plus" title="Create topfolder..." data-command="newTopFolder"></i>
        </span>
        <span class="header-bar-right">
          <span class="auth-user"
            >'' {%- if user_name and show_user %} Authenticated user: "{{user_name}}", realm: "{{realm}}", access: {{access}}. {%- if is_authenticated and show_logout %}
            <a title="Logout current user" href="{{ url }}?logout" target="_blank" rel="noopener noreferrer">Logout</a>
            {% endif -%} {%- if user_roles %} , roles: {{ user_roles }} {% endif -%} {% endif -%}
          </span>
          <i class="wb-button wb-button-toggle bi bi-window-split down" data-command="togglePreview" title="Toggle details pane"></i>
          <i class="wb-button bi bi-gear" data-command="showSettings" title="Settings"></i>
          <i class="wb-button bi bi-question-circle" data-command="showHelp" title="Help"></i>
        </span>
      </div>
      <span id="notification" class="notification"></span>
    </header>
    <div class="main-container">
      <main>
        <div id="tree"></div>
      </main>
      <aside id="rightPane" class="right collapse-horizontal">
        <div id="preview">
          <div id="preview-unknown" class="preview-pane">
            <p>Please select a file or folder.</p>
          </div>
          <img id="preview-img" src="" alt="Image Preview" class="preview-pane hidden" />
          <pre id="preview-text" class="preview-pane hidden"></pre>
          <div id="preview-folder" class="preview-pane hidden">
            <div id="dropzone" class="dropzone">
              <p>Drag and drop files here to upload, or click to select files.</p>
              <input type="file" id="fileInput" multiple style="display: none" />
            </div>
          </div>
          <div id="preview-settings" class="preview-pane hidden">
            <h2>Settings</h2>
            <form id="settingsForm">
              <div class="form-group">
                <label for="max_preview_size_kb">Max preview size (KB)</label>
                <input type="number" id="max_preview_size_kb" name="max_preview_size_kb" min="0" />
              </div>
              <div class="form-group">
                <label for="office_support">Support Office</label>
                <input type="checkbox" id="office_support" name="office_support" />
              </div>
              <div class="form-group">
                <label for="readonly">Open Office documents in readonly mode</label>
                <input type="checkbox" id="readonly" name="readonly" />
              </div>
          </div>
          <iframe id="preview-iframe" class="preview-pane hidden" src="" frameborder="0" title="Preview" style="width: 100%; height: 100%"></iframe>
        </div>
      </aside>
    </div>
    <footer>
      {% if trailer %}
      <p class="trailer">{{ trailer | safe }}</p>
      {% endif %}
    </footer>
  </body>
</html>
